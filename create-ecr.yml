AWSTemplateFormatVersion: 2010-09-09
Description: Creating ECS service
Parameters:
  DevECRName:
    Type: String
    Description: Name of the Dev ECR Repo
    Default: dev-scala-image-repo
  StagingECRName:
    Type: String
    Description: Name of the Staging ECR Repo
    Default: staging-scala-image-repo
    
Resources:       
  ECRA: 
    Type: AWS::ECR::Repository
    Properties: 
      RepositoryName: 
         Ref: DevECRName
      RepositoryPolicyText: 
        Version: "2012-10-17"
        Statement: 
          - 
            Sid: AllowPushPull
            Effect: Allow
            Principal: 
              AWS: 
                Fn::Sub: - "arn:aws:iam::${AWS::AccountId}:user/cloud_user"              
            Action: 
              - "ecr:GetDownloadUrlForLayer"
              - "ecr:BatchGetImage"
              - "ecr:BatchCheckLayerAvailability"
              - "ecr:PutImage"
              - "ecr:InitiateLayerUpload"
              - "ecr:UploadLayerPart"
              - "ecr:CompleteLayerUpload"
           
  ECRB: 
    Type: AWS::ECR::Repository
    Properties: 
      RepositoryName:
         Ref: StagingECRName
      RepositoryPolicyText: 
        Version: "2012-10-17"
        Statement: 
          - 
            Sid: AllowPushPull
            Effect: Allow
            Principal: 
              AWS: 
                - "arn:aws:iam::239875208417:user/cloud_user"              
            Action: 
              - "ecr:GetDownloadUrlForLayer"
              - "ecr:BatchGetImage"
              - "ecr:BatchCheckLayerAvailability"
              - "ecr:PutImage"
              - "ecr:InitiateLayerUpload"
              - "ecr:UploadLayerPart"
              - "ecr:CompleteLayerUpload"
